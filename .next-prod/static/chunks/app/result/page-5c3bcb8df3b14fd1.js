(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[609],{"(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2FUsers%2Fsmartnewbie%2FDesktop%2FMBTI-test-for-dating%2Fsrc%2Fapp%2Fresult%2Fpage.jsx%22%2C%22ids%22%3A%5B%5D%7D&server=false!":function(e,s,t){Promise.resolve().then(t.bind(t,"(app-pages-browser)/./src/app/result/page.jsx"))},"(app-pages-browser)/./src/app/result/page.jsx":function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var r=t("(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js"),o=t("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),n=t("(app-pages-browser)/./node_modules/@mui/material/Box/Box.js"),a=t("(app-pages-browser)/./node_modules/@mui/material/Typography/Typography.js"),i=t("(app-pages-browser)/./node_modules/@mui/material/Button/Button.js"),l=t("(app-pages-browser)/./node_modules/@mui/material/Dialog/Dialog.js"),p=t("(app-pages-browser)/./node_modules/@mui/material/DialogTitle/DialogTitle.js"),d=t("(app-pages-browser)/./node_modules/@mui/material/DialogContent/DialogContent.js"),c=t("(app-pages-browser)/./node_modules/@mui/material/TextField/TextField.js"),u=t("(app-pages-browser)/./node_modules/@mui/material/DialogActions/DialogActions.js"),x=t("(app-pages-browser)/./node_modules/@mui/material/Snackbar/Snackbar.js"),m=t("(app-pages-browser)/./node_modules/@mui/material/Alert/Alert.js"),h=t("(app-pages-browser)/./node_modules/next/dist/api/navigation.js"),g=t("(app-pages-browser)/./src/app/components/animations.jsx"),j=t("(app-pages-browser)/./src/app/components/layout/index.js"),b=t("(app-pages-browser)/./src/app/components/test/TestResult.jsx"),f=t("(app-pages-browser)/./src/app/hooks/useMbtiTest.js"),w=t("(app-pages-browser)/./src/app/contexts/SupabaseContext.jsx"),v=t("(app-pages-browser)/./src/app/services/resultService.js"),y=t("(app-pages-browser)/./src/app/utils/mbti.js"),Z=t("(app-pages-browser)/./src/app/components/mystical/index.js"),C=t("(app-pages-browser)/./node_modules/@mui/icons-material/Favorite.js"),T=t("(app-pages-browser)/./node_modules/@mui/icons-material/Email.js");function F(){let e=(0,h.useRouter)(),s=(0,h.useSearchParams)(),{result:t,idealType:F,worstMatch:_,handleRestartTest:k,isTestCompleted:S}=(0,f.Z)(),{user:I,sessionId:D}=(0,w.$4)(),[B,A]=(0,o.useState)(!0),[M,z]=(0,o.useState)(!1),[E,$]=(0,o.useState)(""),[H,X]=(0,o.useState)(!1),[Y,N]=(0,o.useState)(""),[O,R]=(0,o.useState)(""),[W,q]=(0,o.useState)(null),P=s.get("id");(0,o.useEffect)(()=>{(async()=>{try{if(A(!0),P){let s=await (0,v.by)(P);s?q(s):e.push("/test")}else S||t?t&&!W&&U():e.push("/test")}catch(e){console.error("Error loading result:",e)}finally{A(!1)}})()},[S,t,e,P]);let U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t)try{let{success:s,shareId:r,sessionId:o}=await (0,v.TW)(t.scores,t.mbtiType,null==I?void 0:I.id,D,e);if(s&&r){let e="".concat(window.location.origin,"/result?id=").concat(r);$(e)}}catch(e){console.error("Error saving result:",e)}},G=(e,s)=>{let t="".concat(e," ").concat(s);navigator.clipboard.writeText(t).then(()=>{z(!0)}).catch(e=>{console.error("클립보드 복사 실패:",e)})},J=e=>{let s=(0,y.TA)(e);return(null==s?void 0:s.name)||""};if(B)return(0,r.jsxs)(j.Xg,{variant:"result",children:[(0,r.jsx)(n.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:-1,overflow:"hidden"},children:(0,r.jsx)(Z.I3,{starCount:30,shootingStarCount:2,fogCount:3})}),(0,r.jsxs)(j.$0,{centered:!0,fullHeight:!0,children:[(0,r.jsx)(g.F,{animation:"pulse",duration:"slow",children:(0,r.jsx)(n.Z,{component:"img",src:"/images/tarot-back.svg",alt:"타로 카드",sx:{width:150,height:225,mb:4,animation:"spin 3s linear infinite","@keyframes spin":{"0%":{transform:"rotateY(0deg)"},"100%":{transform:"rotateY(360deg)"}}}})}),(0,r.jsx)(a.Z,{variant:"h4",children:"결과를 불러오는 중..."})]})]});let K=W||t;return K&&K.mbtiType?(0,r.jsxs)(j.Xg,{variant:"result",children:[(0,r.jsx)(n.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:-1,overflow:"hidden"},children:(0,r.jsx)(Z.I3,{starCount:50,shootingStarCount:3,fogCount:5})}),(0,r.jsx)(j.$0,{centered:!0,children:(0,r.jsx)(g.F,{animation:"fadeIn",duration:"normal",children:(0,r.jsxs)(n.Z,{sx:{maxWidth:800,mx:"auto",my:4},children:[(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center",mb:4},children:(0,r.jsx)(g.F,{animation:"pulse",duration:"slow",children:(0,r.jsx)(C.Z,{sx:{fontSize:60,color:"secondary.main",filter:"drop-shadow(0 0 10px rgba(156, 39, 176, 0.5))"}})})}),(0,r.jsx)(a.Z,{variant:"h3",sx:{textAlign:"center",mb:4},children:"당신의 MBTI 연애 유형 결과"}),(0,r.jsx)(b.Z,{mbtiType:K.mbtiType,scores:K.scores,idealType:(null==W?void 0:W.idealType)||F,worstMatch:(null==W?void 0:W.worstMatch)||_,onRestart:()=>{k(),e.push("/test")},onShare:()=>{let e=(null==W?void 0:W.mbtiType)||(null==t?void 0:t.mbtiType),s=J(e),r="내 MBTI 연애 유형은 ".concat(e,"(").concat(s,")! 달빛 연애 연구소에서 당신의 MBTI 연애 유형도 알아보세요!"),o=E||window.location.href;navigator.share?navigator.share({title:"내 MBTI 연애 유형은 ".concat(e,"!"),text:r,url:o}).catch(e=>{console.error("공유 실패:",e),G(r,o)}):G(r,o)}}),!I&&!P&&(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,r.jsx)(i.Z,{variant:"outlined",color:"primary",startIcon:(0,r.jsx)(T.Z,{}),onClick:()=>X(!0),children:"이메일로 결과 저장하기"})})]})})}),(0,r.jsxs)(l.Z,{open:H,onClose:()=>X(!1),children:[(0,r.jsx)(p.Z,{children:"이메일로 결과 저장하기"}),(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(a.Z,{variant:"body2",sx:{mb:2},children:"이메일을 입력하시면 결과를 저장하고 언제든지 다시 확인할 수 있습니다."}),(0,r.jsx)(c.Z,{margin:"dense",label:"이메일",type:"email",fullWidth:!0,variant:"outlined",value:Y,onChange:e=>N(e.target.value),error:!!O,helperText:O})]}),(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(i.Z,{onClick:()=>X(!1),children:"취소"}),(0,r.jsx)(i.Z,{onClick:()=>{if(!Y){R("이메일을 입력해주세요.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y)){R("유효한 이메일 주소를 입력해주세요.");return}U(Y),X(!1)},color:"primary",children:"저장"})]})]}),(0,r.jsx)(x.Z,{open:M,autoHideDuration:3e3,onClose:()=>z(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,r.jsx)(m.Z,{onClose:()=>z(!1),severity:"success",sx:{width:"100%"},children:"결과 링크가 클립보드에 복사되었습니다!"})})]}):(0,r.jsxs)(j.Xg,{variant:"result",children:[(0,r.jsx)(n.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:-1,overflow:"hidden"},children:(0,r.jsx)(Z.I3,{starCount:30,shootingStarCount:2,fogCount:3})}),(0,r.jsx)(j.$0,{centered:!0,fullHeight:!0,children:(0,r.jsxs)(g.F,{animation:"fadeIn",duration:"normal",children:[(0,r.jsx)(a.Z,{variant:"h4",children:"테스트 결과가 없습니다"}),(0,r.jsx)(a.Z,{variant:"body1",sx:{mt:2,mb:4,textAlign:"center"},children:"테스트를 먼저 완료해주세요."}),(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,r.jsx)(g.F,{animation:"pulse",duration:"slow",children:(0,r.jsx)(i.Z,{variant:"contained",color:"primary",onClick:()=>e.push("/test"),size:"large",sx:{px:4,py:1.5},children:"테스트 시작하기"})})})]})})]})}function _(){return(0,r.jsx)(o.Suspense,{fallback:(0,r.jsxs)(j.Xg,{variant:"result",children:[(0,r.jsx)(n.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:-1,overflow:"hidden"},children:(0,r.jsx)(Z.I3,{starCount:30,shootingStarCount:2,fogCount:3})}),(0,r.jsxs)(j.$0,{centered:!0,fullHeight:!0,children:[(0,r.jsx)(g.F,{animation:"pulse",duration:"slow",children:(0,r.jsx)(n.Z,{component:"img",src:"/images/tarot-back.svg",alt:"타로 카드",sx:{width:150,height:225,mb:4,animation:"spin 3s linear infinite","@keyframes spin":{"0%":{transform:"rotateY(0deg)"},"100%":{transform:"rotateY(360deg)"}}}})}),(0,r.jsx)(a.Z,{variant:"h4",children:"결과를 불러오는 중..."})]})]}),children:(0,r.jsx)(F,{})})}}},function(e){e.O(0,[631,934,818,118,422,883,709,336,330,880,864,80,445,235,971,117,744],function(){return e(e.s="(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2FUsers%2Fsmartnewbie%2FDesktop%2FMBTI-test-for-dating%2Fsrc%2Fapp%2Fresult%2Fpage.jsx%22%2C%22ids%22%3A%5B%5D%7D&server=false!")}),_N_E=e.O()}]);
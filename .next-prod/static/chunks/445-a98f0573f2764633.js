"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[445],{"(app-pages-browser)/./src/app/contexts/SupabaseContext.jsx":function(e,t,s){s.d(t,{$4:function(){return p},FV:function(){return a}});var o=s("(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js"),i=s("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),n=s("(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js"),r=s("(app-pages-browser)/./src/app/utils/supabase.js");let u=(0,i.createContext)();function a(e){let{children:t}=e,[s,a]=(0,i.useState)(null),[p,l]=(0,i.useState)(!0),[d,c]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{try{l(!0);let{data:{session:e},error:t}=await r.ZP.auth.getSession();if(t)throw console.error("Error getting session:",t),t;if(a((null==e?void 0:e.user)||null),!(null==e?void 0:e.user)){let e=localStorage.getItem("sessionId");e||(e=(0,n.Z)(),localStorage.setItem("sessionId",e)),c(e)}}catch(e){console.error("Failed to get session:",e)}finally{l(!1)}})();let{data:{subscription:e}}=r.ZP.auth.onAuthStateChange(async(e,t)=>{a((null==t?void 0:t.user)||null),l(!1)});return()=>{e.unsubscribe()}},[]);let m=async(e,t)=>{try{let{data:s,error:o}=await r.ZP.auth.signUp({email:e,password:t});if(o)throw o;return{success:!0,data:s}}catch(e){return console.error("Error signing up:",e),{success:!1,error:e}}},g=async(e,t)=>{try{let{data:s,error:o}=await r.ZP.auth.signInWithPassword({email:e,password:t});if(o)throw o;return{success:!0,data:s}}catch(e){return console.error("Error signing in:",e),{success:!1,error:e}}},h=async()=>{try{let{error:e}=await r.ZP.auth.signOut();if(e)throw e;return{success:!0}}catch(e){return console.error("Error signing out:",e),{success:!1,error:e}}},b=async e=>{try{let{data:t,error:s}=await r.ZP.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(s)throw s;return{success:!0,data:t}}catch(e){return console.error("Error resetting password:",e),{success:!1,error:e}}},w=async e=>{try{let{data:t,error:s}=await r.ZP.auth.updateUser({password:e});if(s)throw s;return{success:!0,data:t}}catch(e){return console.error("Error updating password:",e),{success:!1,error:e}}};return(0,o.jsx)(u.Provider,{value:{user:s,loading:p,sessionId:d,signUp:m,signIn:g,signOut:h,resetPassword:b,updatePassword:w},children:t})}function p(){let e=(0,i.useContext)(u);if(void 0===e)throw Error("useSupabase must be used within a SupabaseProvider");return e}},"(app-pages-browser)/./src/app/hooks/useMbtiTest.js":function(e,t,s){s.d(t,{Z:function(){return I}});var o=s("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),i=s("(app-pages-browser)/./node_modules/next/dist/api/navigation.js"),n=s("(app-pages-browser)/./node_modules/zustand/esm/index.mjs"),r=s("(app-pages-browser)/./node_modules/zustand/esm/middleware.mjs"),u=s("(app-pages-browser)/./src/app/utils/mbtiAnalyzer.js");let a=(0,n.Ue)((0,r.tJ)((e,t)=>({questions:[],currentQuestionIndex:0,responses:{},result:null,isTestStarted:!1,isTestCompleted:!1,sessionId:null,setQuestions:t=>e({questions:t}),setCurrentQuestionIndex:t=>e({currentQuestionIndex:t}),goToNextQuestion:()=>{let{currentQuestionIndex:s,questions:o}=t();s<o.length-1&&e({currentQuestionIndex:s+1})},goToPreviousQuestion:()=>{let{currentQuestionIndex:s}=t();s>0&&e({currentQuestionIndex:s-1})},goToQuestion:s=>{let{questions:o}=t();s>=0&&s<o.length&&e({currentQuestionIndex:s})},addResponse:(s,o)=>{let{responses:i}=t();e({responses:{...i,[s]:o}})},removeResponse:s=>{let{responses:o}=t(),i={...o};delete i[s],e({responses:i})},clearResponses:()=>e({responses:{}}),calculateResult:()=>{let{questions:s,responses:o}=t(),i=Object.entries(o).map(e=>{let[t,s]=e;return{questionId:parseInt(t),answer:s}}),n=(0,u.wy)(s,i);return e({result:n,isTestCompleted:!0}),n},startTest:()=>e({isTestStarted:!0,currentQuestionIndex:0}),completeTest:()=>{let s=t().calculateResult();return e({isTestCompleted:!0,result:s}),s},restartTest:()=>e({currentQuestionIndex:0,responses:{},result:null,isTestCompleted:!1}),getProgress:()=>{let{questions:e,responses:s}=t();return 0===e.length?0:Math.round(Object.keys(s).length/e.length*100)},getCurrentQuestionResponse:()=>{let{questions:e,currentQuestionIndex:s,responses:o}=t();return 0===e.length?null:o[e[s].id]||null},setSessionId:t=>e({sessionId:t}),resetStore:()=>e({questions:[],currentQuestionIndex:0,responses:{},result:null,isTestStarted:!1,isTestCompleted:!1,sessionId:null})}),{name:"mbti-test-storage",storage:(0,r.FL)(()=>sessionStorage)}));var p=s("(app-pages-browser)/./node_modules/@supabase/supabase-js/dist/module/index.js"),l=s("(app-pages-browser)/./src/app/utils/sampleQuestions.js");let d=e=>e.map(e=>({id:e.id,question:e.question,optionA:e.option_a,optionB:e.option_b,dimension:e.dimension,direction:e.direction})),c=(0,p.eI)("https://uboblerxqhlkwesjmvbo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVib2JsZXJ4cWhsa3dlc2ptdmJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0ODU2MTUsImV4cCI6MjA2MzA2MTYxNX0.UoMDiFnu_vEaxMsVxAOQAj8tnVQ4-c0fbkx6HW_hfww"),m=async()=>{try{let{data:e,error:t}=await c.getAllQuestions();if(t)throw console.error("Error fetching questions from Supabase:",t),t;return d(e)}catch(e){return console.error("Failed to fetch questions:",e),[]}},g=()=>l.Z,h=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?g():await m()},b=async function(e,t,s){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{let{data:i,error:n}=o?await c.saveUserResponse(o,t,s):await c.saveAnonymousResponse(e,t,s);if(n)throw console.error("Error saving user response:",n),n;return{success:!0,data:i}}catch(e){return console.error("Failed to save user response:",e),{success:!1,error:e}}};var w=s("(app-pages-browser)/./src/app/utils/mbti.js"),v=s("(app-pages-browser)/./src/app/contexts/SupabaseContext.jsx");function I(){let{useSampleData:e=!1,autoSave:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,n]=(0,o.useState)(!0),[r,p]=(0,o.useState)(null),[l,d]=(0,o.useState)(null),[c,m]=(0,o.useState)(null),g=(0,i.useRouter)(),{user:I,sessionId:f}=(0,v.$4)(),{questions:y,currentQuestionIndex:q,responses:x,result:A,isTestStarted:T,isTestCompleted:S,sessionId:B,setQuestions:j,setCurrentQuestionIndex:C,goToNextQuestion:E,goToPreviousQuestion:Q,goToQuestion:P,addResponse:F,removeResponse:J,clearResponses:_,calculateResult:k,startTest:Z,completeTest:N,restartTest:R,getProgress:M,getCurrentQuestionResponse:O,setSessionId:U,resetStore:z}=a(),V=(0,o.useCallback)(async()=>{try{n(!0);let t=await h(e);j(t),p(null)}catch(e){console.error("Failed to fetch questions:",e),p("질문 데이터를 가져오는 데 실패했습니다.")}finally{n(!1)}},[e,j]),W=(0,o.useCallback)(()=>0===y.length?null:y[q],[y,q]),X=(0,o.useCallback)(async(e,s)=>{let o=W();if(o){if(F(o.id,s),t&&(B||I))try{await b(B,o.id,s,null==I?void 0:I.id)}catch(e){console.error("Failed to save response:",e)}q===y.length-1?D():E()}},[W,F,t,B,I,q,y.length,E]),D=(0,o.useCallback)(async()=>{let e=N();if(e&&e.mbtiType){d((0,w.BW)(e.mbtiType)),m((0,w.cQ)(e.mbtiType));try{await (0,u.TW)(e,null==I?void 0:I.id,B)}catch(e){console.error("Failed to save test result to Supabase:",e)}g.push("/result")}return e},[N,g,I,B]),Y=(0,o.useCallback)(()=>{Z(),g.push("/test/question")},[Z,g]),L=(0,o.useCallback)(()=>{R(),d(null),m(null),g.push("/test")},[R,g]);return(0,o.useEffect)(()=>{0===y.length?V():n(!1)},[y.length,V]),(0,o.useEffect)(()=>{f&&!B&&U(f)},[f,B,U]),(0,o.useEffect)(()=>{A&&A.mbtiType&&!l&&(d((0,w.BW)(A.mbtiType)),m((0,w.cQ)(A.mbtiType)))},[A,l]),{loading:s,error:r,questions:y,currentQuestionIndex:q,currentQuestion:W(),responses:x,result:A,isTestStarted:T,isTestCompleted:S,progress:M(),currentResponse:O(),idealType:l,worstMatch:c,mbtiResult:null==A?void 0:A.mbtiType,fetchQuestions:V,saveAnswer:X,goToNextQuestion:E,goToPreviousQuestion:Q,handleStartTest:Y,handleRestartTest:L,finishTest:D,goToQuestion:P,clearResponses:_,resetStore:z}}},"(app-pages-browser)/./src/app/utils/sampleQuestions.js":function(e,t){t.Z=[{id:1,question:"연인과 함께 있을 때 나는",optionA:"다양한 활동과 대화를 통해 에너지를 얻는다",optionB:"조용한 시간을 함께 보내며 에너지를 얻는다",dimension:"E-I",direction:"positive"},{id:2,question:"데이트 장소로 더 선호하는 곳은",optionA:"활기찬 페스티벌이나 사람이 많은 장소",optionB:"조용한 카페나 한적한 장소",dimension:"E-I",direction:"positive"},{id:3,question:"연인과의 갈등 후 나는",optionA:"바로 대화하고 해결하고 싶다",optionB:"혼자 생각할 시간이 필요하다",dimension:"E-I",direction:"positive"},{id:4,question:"연인의 친구들을 만날 때 나는",optionA:"새로운 사람들과 만나는 것이 즐겁다",optionB:"부담스럽고 에너지가 소모된다",dimension:"E-I",direction:"positive"},{id:5,question:"연애 중 힘든 일이 있을 때 나는",optionA:"여러 사람들과 이야기하며 해소한다",optionB:"혼자 생각하거나 가까운 한두 명에게만 털어놓는다",dimension:"E-I",direction:"positive"},{id:6,question:"연인과의 관계에서 나는",optionA:"함께하는 활동과 경험을 중요시한다",optionB:"깊은 대화와 정서적 연결을 중요시한다",dimension:"E-I",direction:"negative"},{id:7,question:"연인과의 대화에서 나는",optionA:"구체적인 일상과 현실적인 주제를 선호한다",optionB:"미래의 가능성과 추상적인 주제를 선호한다",dimension:"S-N",direction:"positive"},{id:8,question:"연인에게 선물을 고를 때 나는",optionA:"실용적이고 당장 필요한 것을 선택한다",optionB:"의미 있고 창의적인 것을 선택한다",dimension:"S-N",direction:"positive"},{id:9,question:"연인과의 여행에서 나는",optionA:"구체적인 일정과 계획을 중요시한다",optionB:"새로운 가능성과 즉흥적인 경험을 중요시한다",dimension:"S-N",direction:"positive"},{id:10,question:"연인과의 미래를 생각할 때 나는",optionA:"현실적인 계획과 단계를 고려한다",optionB:"관계의 성장 가능성과 비전을 그린다",dimension:"S-N",direction:"positive"},{id:11,question:"연인의 이야기를 들을 때 나는",optionA:"구체적인 사실과 세부사항에 집중한다",optionB:"이야기의 의미와 패턴에 집중한다",dimension:"S-N",direction:"positive"},{id:12,question:"연인과 함께 영화를 볼 때 나는",optionA:"현실적이고 사실적인 이야기를 선호한다",optionB:"상상력이 풍부하고 창의적인 이야기를 선호한다",dimension:"S-N",direction:"negative"},{id:13,question:"연인과의 중요한 결정에서 나는",optionA:"논리와 객관적인 사실을 기반으로 판단한다",optionB:"감정과 가치관을 기반으로 판단한다",dimension:"T-F",direction:"positive"},{id:14,question:"연인과의 갈등 상황에서 나는",optionA:"논리적으로 문제를 분석하고 해결책을 찾는다",optionB:"서로의 감정을 고려하며 조화롭게 해결하려 한다",dimension:"T-F",direction:"positive"},{id:15,question:"연인이 힘든 일을 겪을 때 나는",optionA:"문제 해결을 위한 실질적인 조언을 제공한다",optionB:"공감하고 정서적 지지를 보낸다",dimension:"T-F",direction:"positive"},{id:16,question:"연인의 의견이 나와 다를 때 나는",optionA:"객관적인 사실을 바탕으로 논리적으로 접근한다",optionB:"서로의 가치관과 감정을 고려하여 접근한다",dimension:"T-F",direction:"positive"},{id:17,question:"연인에게 나의 마음을 표현할 때 나는",optionA:"직접적이고 명확하게 표현한다",optionB:"섬세하고 따뜻한 방식으로 표현한다",dimension:"T-F",direction:"positive"},{id:18,question:"연인이 나에게 조언을 구할 때 나는",optionA:"객관적이고 솔직한 의견을 제공한다",optionB:"상대방의 감정을 고려한 조언을 제공한다",dimension:"T-F",direction:"negative"},{id:19,question:"연애할 때 데이트 계획은",optionA:"미리 계획을 세우고 준비하는 게 좋다",optionB:"즉흥적으로 결정해도 괜찮다",dimension:"J-P",direction:"positive"},{id:20,question:"연인과의 약속에 나는",optionA:"정확한 시간과 장소를 미리 정해두는 것이 중요하다",optionB:"상황에 따라 유연하게 변경할 수 있는 것이 좋다",dimension:"J-P",direction:"positive"},{id:21,question:"연인과의 여행에서 나는",optionA:"일정과 방문할 장소를 미리 계획한다",optionB:"그때그때 끌리는 곳을 자유롭게 탐험한다",dimension:"J-P",direction:"positive"},{id:22,question:"연인과 함께 결정을 내릴 때 나는",optionA:"빠르게 결정하고 실행에 옮기는 것을 선호한다",optionB:"더 많은 정보와 가능성을 탐색하는 것을 선호한다",dimension:"J-P",direction:"positive"},{id:23,question:"연인과의 일상에서 나는",optionA:"규칙적이고 체계적인 생활을 선호한다",optionB:"자유롭고 융통성 있는 생활을 선호한다",dimension:"J-P",direction:"positive"},{id:24,question:"연인과의 미래 계획에 대해 나는",optionA:"구체적인 목표와 단계를 설정하는 것이 중요하다",optionB:"상황에 따라 유연하게 조정하는 것이 중요하다",dimension:"J-P",direction:"negative"}]}}]);